<!DOCTYPE html>
<html>

<head>
    <title>page to print</title>
</head>

<body>

    <select id="printersList">
    </select>

    <button onclick="print()">Print</button>

    <button onclick="listPrinters()">List Printers</button>

    <button onclick="closeSocket();return false;">Close</button> 

    <script type="text/javascript" src="Scripts/blob-util.min.js"></script>
    <script type="text/javascript" src="Scripts/fileprint.api.js?v=2"></script>

    <script type="text/javascript">
        var fileprint = new FilePrint(0 /*timeout for closing*/, true /*useBinary for getting the file.*/, function ready() {

        }, function erroResult(error) {

        });
        fileprint.setup();

        function listPrinters() {
            fileprint.getPrinters(function listprinters(data) {
                console.log(data);
                fillPrinters(data.list);
            });
        }

        function closeSocket() {
            fileprint.close()
        }

        function print() {

            var e = document.getElementById("printersList");
            var strPrinterName = e.options[e.selectedIndex].value;

            //fileprint.printPDF(strPrinterName, 'http://localhost:7665/test.pdf', true/*raw-printing*/);

            fileprint.printHTML(strPrinterName, 'http://localhost:7665/test.html', false/*raw-printing*/, false, '-l 0.11 -r 0.05');

            //fileprint.printIMAGE(strPrinterName, 'http://localhost:7665/test.jpg', "jpg", true/*raw-printing*/, 200, 100);

            //fileprint.printWORD(strPrinterName, 'http://localhost:7665/test.docx', "docx", false/*raw-printing*/);
        }

        function fillPrinters(list) {
            var select = document.getElementById('printersList');

            for (var i = 0; i < list.length; i++) {
                var opt = document.createElement('option');
                opt.value = list[i].name;
                opt.innerHTML = list[i].name;
                select.appendChild(opt);
            }
        }
    </script>

</body>

</html>